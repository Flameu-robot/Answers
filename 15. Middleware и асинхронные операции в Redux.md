
**Middleware (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π)** ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É –≤—ã–∑–æ–≤–æ–º `dispatch(action)` –∏ –ø–µ—Ä–µ–¥–∞—á–µ–π —ç—Ç–æ–≥–æ action –≤ —Ä–µ–¥—å—é—Å–µ—Ä. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ–±–µ:

- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, AJAX-–∑–∞–ø—Ä–æ—Å—ã)
- –ò–∑–º–µ–Ω—è—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω—è—Ç—å –¥–µ–π—Å—Ç–≤–∏—è
- –î–µ–ª–∞—Ç—å –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

```js
import { applyMiddleware, createStore } from 'redux';
import thunk from 'redux-thunk';
import logger from 'redux-logger';

const store = createStore(
  rootReducer,
  applyMiddleware(thunk, logger)
);
```

**–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ –≤—ã–∑–æ–≤–∞:**
![[Pasted image 20250530143945.png]]
dispatch(action) ‚Üí<font color="#00b0f0"><u>middleware</u></font> ‚Üí reducer ‚Üí store.update()

Middleware –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ `dispatch` –∏ `getState`, –ø–æ—ç—Ç–æ–º—É –º–æ–∂–µ—Ç:

- –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π action
- –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –í—ã–∑–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π middleware –≤ —Ü–µ–ø–æ—á–∫–µ
  
```js
const loggerMiddleware = (storeAPI) => (next) => (action) => {
  console.log('–î–æ:', storeAPI.getState());
  const result = next(action); // –ü–µ—Ä–µ–¥–∞—ë–º action –¥–∞–ª—å—à–µ
  console.log('–ü–æ—Å–ª–µ:', storeAPI.getState());
  return result;
};
```

# ‚è±Ô∏è –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ Redux

Redux –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–±–æ—Ç–∞–µ—Ç **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ** ‚Äî –æ–Ω —Å—Ä–∞–∑—É –∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç action –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –ù–æ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–∞—Å—Ç–æ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–±–æ—Ç—ã —Å API, —Ç–∞–π–º–µ—Ä–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏.
–î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **middleware** , –∫–æ—Ç–æ—Ä—ã–µ —É–º–µ—é—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.

## üîÑ –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏

### 1. üîÅ **Redux Thunk**

Thunk ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏—Ç—å –≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–≥–æ action. –≠—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –¥–æ–±–∞–≤–∏—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –≤ Redux.

```js
// Action creator
function fetchData() {
  return async function fetchUserData(dispatch, getState) {
    dispatch({ type: 'data/fetchStart' });

    try {
      const response = await fetch('/api/users');
      const data = await response.json();

      dispatch({ type: 'data/fetchSuccess', payload: data });
    } catch (error) {
      dispatch({ type: 'data/fetchFailed', payload: error.message });
    }
  };
}

// –ì–¥–µ-—Ç–æ –≤ –∫–æ–¥–µ:
store.dispatch(fetchData());
```
### 2. üì¶ **Redux Toolkit + createAsyncThunk**

Redux Toolkit –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `createAsyncThunk`, –∫–æ—Ç–æ—Ä–∞—è —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
```js
import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';

// –°–æ–∑–¥–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π thunk
export const fetchUserById = createAsyncThunk(
  'users/fetchById',
  async (userId) => {
    const response = await fetch(`/api/users/${userId}`);
    return await response.json();
  }
);

const userSlice = createSlice({
  name: 'user',
  initialState: { loading: false, data: null, error: null },
  reducers: {},
  extraReducers: (builder) => {
    builder
      .addCase(fetchUserById.pending, (state) => {
        state.loading = true;
      })
      .addCase(fetchUserById.fulfilled, (state, action) => {
        state.loading = false;
        state.data = action.payload;
      })
      .addCase(fetchUserById.rejected, (state, action) => {
        state.loading = false;
        state.error = action.error.message;
      });
  },
});
```
